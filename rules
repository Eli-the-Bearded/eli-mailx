#!/usr/bin/make -f
# Sample debian.rules file - for GNU Hello (1.3).
# Copyright 1994,1995 by Ian Jackson.
# I hereby give you perpetual unlimited permission to copy,
# modify and relicense this file, provided that you do not remove
# my name from the file itself.  (I assert my moral right of
# paternity under the Copyright, Designs and Patents Act 1988.)
# This file may have to be extensively modified
#

package=mailx

CFLAGS=-O2
CC=gcc

build:
	dh_testdir
	make CFLAGS="$(CFLAGS)" CC="$(CC)"
	cd USD.doc && make 
	touch build

clean:
	dh_testdir
	dh_testroot
	-rm -f build
	-make clean
	-rm USD.doc/manual.ps
	dh_clean

binary-indep:	build
# There are no architecture-independent files to be uploaded
# generated by this package.  If there were any they would be
# made here.

binary-arch: build
	dh_testdir
	dh_testroot
	dh_clean -k
	dh_installdirs
	make install DESTDIR=`pwd`/debian/tmp
	cd debian/tmp/usr/bin && ln -fs mail mailx
	cd debian/tmp/usr/bin && ln -fs mail Mail
# if no debstd, uncomment following lines (taken from Martin Mitchell)
#	install -d debian/tmp/usr/doc/mailx debian/tmp/DEBIAN
#	gzip -9v debian/tmp/usr/man/man1/*
#	cd debian/tmp/usr/man/man1 && ln -fs mail.1.gz mailx.1.gz
#	cd debian/tmp/usr/man/man1 && ln -fs mail.1.gz Mail.1.gz
#	cp debian/changelog debian/README.debian USD.doc/manual.ps debian/tmp/usr/doc/mailx
#	gzip -9v debian/tmp/usr/doc/mailx/*
#	cp debian/copyright debian/tmp/usr/doc/mailx
#	cp debian/{control,conffiles,preinst} debian/tmp/DEBIAN
#	dpkg-shlibdeps debian/tmp/usr/bin/mail
# Must have debmake installed for this to work. Otherwise please copy
# /usr/bin/debstd into the debian directory and change debstd to debian/debstd
	cd debian/tmp/usr/man/man1 && ln -fs mail.1 mailx.1
	cd debian/tmp/usr/man/man1 && ln -fs mail.1 Mail.1
	dh_installdocs USD.doc/manual.ps
#	dh_installexamples
#	dh_installmenu
#	dh_installcron
#	dh_installmanpages
	dh_installchangelogs
	dh_strip
	dh_compress
	dh_fixperms
	chgrp mail debian/tmp/usr/bin/mail
	chmod g+s debian/tmp/usr/bin/mail
	dh_suidregister
	dh_installdeb
	dh_shlibdeps
	dh_gencontrol
#	dh_makeshlibs
	dh_md5sums
	dh_builddeb

# Below here is fairly generic really

binary:		binary-indep binary-arch


.PHONY: binary binary-arch binary-indep clean

# Local Variables:
# mode: makefile
# End variables
